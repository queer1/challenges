# IDAPython script, not to be ran directly;
# the following lines of code should be executed one by one
# after pausing the debugger, see blogpost:
# http://jbremer.org/malware-lu-hackgyver-challenges/

proto = 'int __usercall decrypt<eax>(const char *a<ecx>);'
fn = Appcall.proto(0x12f1000, proto)

for x in xrange(10000, 100000):
    if fn(str(x)):
        print x
        break
